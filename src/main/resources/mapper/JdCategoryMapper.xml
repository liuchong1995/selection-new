<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jidong.productselection.dao.JdCategoryMapper">
	<resultMap id="BaseResultMap" type="com.jidong.productselection.entity.JdCategory">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		<id column="category_id" jdbcType="INTEGER" property="categoryId"/>
		<result column="category_name" jdbcType="VARCHAR" property="categoryName"/>
		<result column="product_id" jdbcType="INTEGER" property="productId"/>
		<result column="category_level" jdbcType="INTEGER" property="categoryLevel"/>
		<result column="parent_id" jdbcType="INTEGER" property="parentId"/>
		<result column="is_leaf" jdbcType="BIT" property="isLeaf"/>
		<result column="components_id" jdbcType="VARCHAR" property="componentsId"/>
		<result column="category_order" jdbcType="INTEGER" property="categoryOrder"/>
		<result column="category_properties" jdbcType="VARCHAR" property="categoryProperties"/>
		<result column="is_show" jdbcType="BIT" property="isShow"/>
	</resultMap>
	<resultMap id="TreeResultMap" type="com.jidong.productselection.entity.JdCategory">
		<id column="category_id" jdbcType="INTEGER" property="categoryId"/>
		<result column="category_name" jdbcType="VARCHAR" property="categoryName"/>
		<result column="product_id" jdbcType="INTEGER" property="productId"/>
		<result column="category_level" jdbcType="INTEGER" property="categoryLevel"/>
		<result column="parent_id" jdbcType="INTEGER" property="parentId"/>
		<result column="is_leaf" jdbcType="BIT" property="isLeaf"/>
		<result column="components_id" jdbcType="VARCHAR" property="componentsId"/>
		<result column="category_order" jdbcType="INTEGER" property="categoryOrder"/>
		<result column="category_properties" jdbcType="VARCHAR" property="categoryProperties"/>
		<result column="is_show" jdbcType="BIT" property="isShow"/>
		<collection property="children" ofType="com.jidong.productselection.entity.JdCategory"
		            select="com.jidong.productselection.dao.JdCategoryMapper.getNewMenuTree" column="category_id">
		</collection>
	</resultMap>
	<sql id="Base_Column_List">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		category_id, category_name, product_id, category_level, parent_id, is_leaf, components_id,
		category_order, category_properties, is_show
	</sql>
	<select id="getNewMenuTree" resultMap="TreeResultMap">
		select d1.*from jd_category d1 where d1.product_id=#{prdId} AND d1.parent_id=#{parentId} AND d1.is_show=1;
	</select>
	<select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		select
		<include refid="Base_Column_List"/>
		from jd_category
		where category_id = #{categoryId,jdbcType=INTEGER}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		delete from jd_category
		where category_id = #{categoryId,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.jidong.productselection.entity.JdCategory">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		insert into jd_category (category_id, category_name, product_id,
		category_level, parent_id, is_leaf,
		components_id, category_order, category_properties,
		is_show)
		values (#{categoryId,jdbcType=INTEGER}, #{categoryName,jdbcType=VARCHAR}, #{productId,jdbcType=INTEGER},
		#{categoryLevel,jdbcType=INTEGER}, #{parentId,jdbcType=INTEGER}, #{isLeaf,jdbcType=BIT},
		#{componentsId,jdbcType=VARCHAR}, #{categoryOrder,jdbcType=INTEGER}, #{categoryProperties,jdbcType=VARCHAR},
		#{isShow,jdbcType=BIT})
	</insert>
	<insert id="insertSelective" parameterType="com.jidong.productselection.entity.JdCategory">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		insert into jd_category
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="categoryId != null">
				category_id,
			</if>
			<if test="categoryName != null">
				category_name,
			</if>
			<if test="productId != null">
				product_id,
			</if>
			<if test="categoryLevel != null">
				category_level,
			</if>
			<if test="parentId != null">
				parent_id,
			</if>
			<if test="isLeaf != null">
				is_leaf,
			</if>
			<if test="componentsId != null">
				components_id,
			</if>
			<if test="categoryOrder != null">
				category_order,
			</if>
			<if test="categoryProperties != null">
				category_properties,
			</if>
			<if test="isShow != null">
				is_show,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="categoryId != null">
				#{categoryId,jdbcType=INTEGER},
			</if>
			<if test="categoryName != null">
				#{categoryName,jdbcType=VARCHAR},
			</if>
			<if test="productId != null">
				#{productId,jdbcType=INTEGER},
			</if>
			<if test="categoryLevel != null">
				#{categoryLevel,jdbcType=INTEGER},
			</if>
			<if test="parentId != null">
				#{parentId,jdbcType=INTEGER},
			</if>
			<if test="isLeaf != null">
				#{isLeaf,jdbcType=BIT},
			</if>
			<if test="componentsId != null">
				#{componentsId,jdbcType=VARCHAR},
			</if>
			<if test="categoryOrder != null">
				#{categoryOrder,jdbcType=INTEGER},
			</if>
			<if test="categoryProperties != null">
				#{categoryProperties,jdbcType=VARCHAR},
			</if>
			<if test="isShow != null">
				#{isShow,jdbcType=BIT},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.jidong.productselection.entity.JdCategory">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		update jd_category
		<set>
			<if test="categoryName != null">
				category_name = #{categoryName,jdbcType=VARCHAR},
			</if>
			<if test="productId != null">
				product_id = #{productId,jdbcType=INTEGER},
			</if>
			<if test="categoryLevel != null">
				category_level = #{categoryLevel,jdbcType=INTEGER},
			</if>
			<if test="parentId != null">
				parent_id = #{parentId,jdbcType=INTEGER},
			</if>
			<if test="isLeaf != null">
				is_leaf = #{isLeaf,jdbcType=BIT},
			</if>
			<if test="componentsId != null">
				components_id = #{componentsId,jdbcType=VARCHAR},
			</if>
			<if test="categoryOrder != null">
				category_order = #{categoryOrder,jdbcType=INTEGER},
			</if>
			<if test="categoryProperties != null">
				category_properties = #{categoryProperties,jdbcType=VARCHAR},
			</if>
			<if test="isShow != null">
				is_show = #{isShow,jdbcType=BIT},
			</if>
		</set>
		where category_id = #{categoryId,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.jidong.productselection.entity.JdCategory">
		<!--
		  WARNING - @mbg.generated
		  This element is automatically generated by MyBatis Generator, do not modify.
		-->
		update jd_category
		set category_name = #{categoryName,jdbcType=VARCHAR},
		product_id = #{productId,jdbcType=INTEGER},
		category_level = #{categoryLevel,jdbcType=INTEGER},
		parent_id = #{parentId,jdbcType=INTEGER},
		is_leaf = #{isLeaf,jdbcType=BIT},
		components_id = #{componentsId,jdbcType=VARCHAR},
		category_order = #{categoryOrder,jdbcType=INTEGER},
		category_properties = #{categoryProperties,jdbcType=VARCHAR},
		is_show = #{isShow,jdbcType=BIT}
		where category_id = #{categoryId,jdbcType=INTEGER}
	</update>

	<select id="getMenuTree" resultType="java.util.HashMap">
		select
			category_id    "id",
			category_name  "text",
			parent_id      "parentid",
			category_level "level",
			is_leaf        "isLeaf",
			is_show        "isShow"
		from jd_category
		where product_id = #{prdId,jdbcType=INTEGER}
	</select>

	<!--auto generated by codehelper on 2018-10-19-->
	<select id="findByCategoryIdIn" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List"/>
		from jd_category
		where category_id in
		<foreach close=")" collection="categoryIdList" index="index" item="item" open="(" separator=",">
			#{item,jdbcType=INTEGER}
		</foreach>
	</select>

	<!--auto generated by codehelper on 2018-10-19-->
	<select id="findByProductId" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List"/>
		from jd_category
		where product_id=#{productId,jdbcType=INTEGER}
	</select>

	<!--auto generated by codehelper on 2018-10-25-->
	<select id="findByProductIdAndParentIdAndCategoryId" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List"/>
		from jd_category
		where product_id=#{productId,jdbcType=INTEGER} and parent_id=#{parentId,jdbcType=INTEGER} and
		category_id &lt;&gt; #{categoryId,jdbcType=INTEGER}
	</select>

	<!--auto generated by codehelper on 2018-10-25-->
	<select id="findByProductIdAndParentId" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List"/>
		from jd_category
		where product_id=#{productId,jdbcType=INTEGER} and parent_id=#{parentId,jdbcType=INTEGER}
	</select>

	<!--auto generated by codehelper on 2018-11-01-->
	<select id="findNextCategoryId" resultType="java.lang.Integer">
		select isnull(max(category_id + 1), 1) as maxcategoryId
		from jd_category</select>

	<!--auto generated by codehelper on 2018-11-01-->
	<select id="findNextCategoryOrder" resultType="java.lang.Integer">
		select isnull(max(category_order + 1), 1) as maxcategoryOrder
		from jd_category
	</select>

	<!--auto generated by codehelper on 2018-11-20-->
	<select id="findByParentId" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List"/>
		from jd_category
		where parent_id=#{parentId,jdbcType=INTEGER}
	</select>

</mapper>